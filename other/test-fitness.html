<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ApexTrack - Интерактивный Прототип</title>
    
    <!-- 1. Шрифты: Inter с Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- 2. Графики: Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; min-height: 100vh; margin: 0; padding: 0; box-sizing: border-box; }
        .app-container { width: 100%; max-width: 500px; background-color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); display: flex; flex-direction: column; min-height: 100vh; position: relative; overflow: hidden; }
        .app-screen { flex-grow: 1; overflow-y: auto; padding: 1rem; -ms-overflow-style: none; scrollbar-width: none; }
        .app-screen::-webkit-scrollbar { display: none; }
        .bottom-nav { background-color: white; border-top: 1px solid #e5e7eb; display: flex; justify-content: space-around; padding: 0.5rem 0; position: sticky; bottom: 0; width: 100%; z-index: 10; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; color: #6b7280; transition: color 0.2s; cursor: pointer; }
        .nav-item.active { color: #6366f1; }
        .nav-item svg { width: 1.5rem; height: 1.5rem; margin-bottom: 0.25rem; }
        .filter-active { background-color: #e0e7ff !important; color: #4338ca !important; font-weight: 600; }
        .chat-screen-container { display: flex; flex-direction: column; height: 100%; padding: 0; }
    </style>
</head>
<body>

    <div class="app-container">
    
        <div id="custom-alert" class="absolute top-0 left-4 right-4 mt-4 transform -translate-y-24 transition-transform duration-300 ease-in-out z-50">
            <div class="bg-green-500 text-white text-center text-sm font-medium p-3 rounded-lg shadow-lg"><span id="alert-message"></span></div>
        </div>

        <!-- Верхняя панель (Теперь отображается/скрывается в зависимости от экрана) -->
        <div id="main-top-bar" class="p-4 flex justify-between items-center border-b border-gray-100 bg-white">
            <div class="flex items-center space-x-2 cursor-pointer" data-alert="Открываем профиль пользователя..."><img src="https://i.pravatar.cc/40?img=1" alt="Профиль" class="h-10 w-10 rounded-full border-2 border-indigo-300"><span class="font-semibold text-lg text-gray-800">ApexTrack</span></div>
            <div class="flex space-x-4">
                <button class="text-gray-500 hover:text-gray-700" data-alert="Открываем экран уведомлений..."><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg></button>
            </div>
        </div>

        <!-- ЭКРАН: Дашборд -->
        <div class="app-screen" id="dashboard">
             <h2 class="text-xl font-bold text-gray-800 mb-4">Дашборд</h2>
            <div class="bg-indigo-600 text-white rounded-lg p-4 mb-6 shadow-lg">
                <p class="text-sm font-semibold opacity-80 mb-1">Фокус Сегодня</p><h3 class="text-2xl font-bold mb-2">Силовая на все тело</h3><p class="text-sm opacity-90 mb-4">Следующая тренировка в 18:00.</p>
                <button class="bg-white text-indigo-600 px-4 py-2 rounded-full text-sm font-semibold shadow-md hover:bg-indigo-50" data-alert="Начинаем тренировку 'Силовая на все тело'...">Начать тренировку</button>
            </div>
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Последняя активность</h3>
                <ul class="space-y-3">
                    <li class="bg-gray-50 p-3 rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-100 transition" data-alert="Просмотр деталей 'Утренней пробежки'"><div><p class="font-medium text-gray-800">Утренняя пробежка</p><p class="text-xs text-gray-500">30 мин • 5 км • 320 кал</p></div><span class="text-sm text-gray-600">Вчера</span></li>
                </ul>
            </div>
            <div class="h-20"></div>
        </div>

        <!-- ЭКРАН: Тренировки -->
        <div class="app-screen hidden" id="workouts">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Тренировки</h2>
            <div class="h-20"></div>
        </div>
        
        <!-- ЭКРАН: Прогресс -->
        <div class="app-screen hidden" id="progress">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Прогресс</h2>
            <div class="mb-6"><h3 class="text-lg font-semibold text-gray-800 mb-3">Динамика веса</h3><div class="relative h-56 w-full bg-gray-50 p-2 rounded-lg"><canvas id="progressChart"></canvas></div></div>
            <div class="mb-6"><h3 class="text-lg font-semibold text-gray-800 mb-3">Личные рекорды</h3><ul class="space-y-3"><li class="bg-gray-50 p-3 rounded-lg flex justify-between items-center cursor-pointer hover:bg-gray-100 transition" data-alert="История рекордов 'Жим лежа'"><div><p class="font-medium text-gray-800">Жим лежа</p><p class="text-xs text-gray-500">1ПМ</p></div><span class="text-indigo-600 font-semibold">100 кг</span></li></ul></div>
            <div class="h-20"></div>
        </div>

        <!-- ЭКРАН: Чат с тренером -->
        <div class="app-screen hidden chat-screen-container" id="chat">
            <!-- Верхняя панель чата -->
            <div class="p-4 flex items-center border-b border-gray-200 bg-white flex-shrink-0">
                <img src="https://i.pravatar.cc/40?img=5" alt="Тренер" class="h-10 w-10 rounded-full mr-3">
                <div>
                    <h2 class="font-semibold text-gray-800">Тренер Алекс</h2>
                    <p class="text-xs text-green-500">В сети</p>
                </div>
            </div>
            <!-- Окно сообщений -->
            <div id="chat-log" class="flex-grow p-4 space-y-4 overflow-y-auto">
                <!-- Сообщения тренера -->
                <div class="flex items-start"><img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full mr-2 flex-shrink-0"><div class="bg-gray-100 text-gray-800 p-3 rounded-lg max-w-xs"><p>Привет! Готов к быстрой и эффективной тренировке?</p></div></div>
                <div class="flex items-start"><img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full mr-2 flex-shrink-0"><div class="bg-gray-100 text-gray-800 p-3 rounded-lg max-w-xs"><p>Я подготовил для тебя короткий HIIT-комплекс на 3 круга. Он отлично взбодрит! Нажми, когда будешь готов.</p></div></div>
                <!-- Сообщение с заданием -->
                <div class="flex items-start"><img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full mr-2 flex-shrink-0"><div class="bg-indigo-50 text-gray-800 p-4 rounded-lg max-w-xs border border-indigo-200"><p class="font-semibold mb-2">HIIT: Быстрый старт</p><p class="text-sm mb-4">3 круга • 4 упражнения</p><button id="start-task-btn" class="w-full bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold text-sm">Начать тренировку</button></div></div>
            </div>
            <!-- Поле ввода сообщения -->
            <div class="p-4 bg-white border-t border-gray-200 flex-shrink-0"><div class="flex"><input type="text" id="chat-input" placeholder="Написать сообщение..." class="flex-grow border border-gray-300 rounded-l-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm"><button id="send-message-btn" class="bg-indigo-600 text-white px-4 rounded-r-full font-semibold text-sm">▶</button></div></div>
        </div>

        <!-- Оверлей выполнения задания -->
        <div id="workout-overlay" class="hidden absolute inset-0 bg-gray-900 bg-opacity-95 z-20 flex flex-col items-center justify-center text-white p-4 text-center">
            <p id="workout-round" class="text-lg font-semibold text-indigo-300 mb-2">Круг 1 из 3</p>
            <h2 id="exercise-name" class="text-4xl font-bold mb-4">Прыжки «Джек»</h2>
            <div id="timer-display" class="text-8xl font-bold mb-6">30</div>
            <p class="text-gray-400 mb-8">Следующее: <span id="next-exercise-name">Высокие колени</span></p>
            <button id="end-workout-btn" class="bg-red-600 px-6 py-2 rounded-full font-semibold">Завершить</button>
        </div>

        <!-- Оверлей статистики -->
        <div id="summary-overlay" class="hidden absolute inset-0 bg-gray-900 bg-opacity-95 z-20 flex flex-col items-center justify-center p-4">
            <div class="bg-white rounded-lg p-6 text-center shadow-xl w-full max-w-sm">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Отличная работа!</h2>
                <p class="text-gray-500 mb-6">Вот твоя статистика:</p>
                <div class="grid grid-cols-3 gap-4 mb-6">
                    <div><p class="text-3xl font-bold text-indigo-600">3</p><p class="text-sm text-gray-500">Круга</p></div>
                    <div><p class="text-3xl font-bold text-indigo-600">6:30</p><p class="text-sm text-gray-500">Время</p></div>
                    <div><p class="text-3xl font-bold text-indigo-600">~95</p><p class="text-sm text-gray-500">Ккал</p></div>
                </div>
                <button id="close-summary-btn" class="w-full bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold text-sm">Готово</button>
            </div>
        </div>

        <!-- Нижнее навигационное меню -->
        <div class="bottom-nav">
            <a class="nav-item active" data-target="dashboard"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg><span>Дашборд</span></a>
            <a class="nav-item" data-target="workouts"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 14v6m-3-3h6M6 10h2a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2zm10 0h2a2 2 0 002-2V6a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM6 20h2a2 2 0 002-2v-2a2 2 0 00-2-2H6a2 2 0 00-2 2v2a2 2 0 002 2z"></path></svg><span>Тренировки</span></a>
            <a class="nav-item" data-target="progress"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><span>Прогресс</span></a>
            <a class="nav-item" data-target="chat"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><span>Тренер</span></a>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Глобальные переменные и элементы ---
            const navItems = document.querySelectorAll('.bottom-nav .nav-item');
            const appScreens = document.querySelectorAll('.app-screen');
            const mainTopBar = document.getElementById('main-top-bar');
            
            // Элементы кастомного алерта
            const alertContainer = document.getElementById('custom-alert');
            const alertMessageSpan = document.getElementById('alert-message');
            let alertTimeout;
            
            // Элементы чата и тренировки
            const workoutOverlay = document.getElementById('workout-overlay');
            const summaryOverlay = document.getElementById('summary-overlay');

            // --- Логика кастомного алерта ---
            function showAlert(message) {
                clearTimeout(alertTimeout);
                alertMessageSpan.textContent = message;
                alertContainer.classList.remove('-translate-y-24');
                alertTimeout = setTimeout(() => { alertContainer.classList.add('-translate-y-24'); }, 2500);
            }

            // --- Логика переключения экранов ---
            function showScreen(targetId) {
                appScreens.forEach(screen => screen.classList.toggle('hidden', screen.id !== targetId));
                mainTopBar.classList.toggle('hidden', targetId === 'chat'); // Скрываем верхнюю панель в чате
            }

            function setActiveNav(activeItem) {
                navItems.forEach(item => item.classList.remove('active'));
                activeItem.classList.add('active');
            }

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = item.dataset.target;
                    showScreen(targetId);
                    setActiveNav(item);
                });
            });

            // --- Логика эмуляции нажатий ---
            document.querySelectorAll('[data-alert]').forEach(element => {
                element.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showAlert(element.dataset.alert);
                });
            });

            // --- Логика чата ---
            const chatLog = document.getElementById('chat-log');
            const chatInput = document.getElementById('chat-input');
            document.getElementById('send-message-btn').addEventListener('click', () => {
                const messageText = chatInput.value.trim();
                if (messageText) {
                    const messageEl = document.createElement('div');
                    messageEl.className = 'flex justify-end';
                    messageEl.innerHTML = `<div class="bg-indigo-600 text-white p-3 rounded-lg max-w-xs"><p>${messageText}</p></div>`;
                    chatLog.appendChild(messageEl);
                    chatInput.value = '';
                    chatLog.scrollTop = chatLog.scrollHeight; // Автопрокрутка вниз
                }
            });

            // --- Логика круговой тренировки ---
            const workoutPlan = {
                totalRounds: 3,
                exercises: [
                    { name: "Прыжки «Джек»", duration: 30 },
                    { name: "Высокие колени", duration: 30 },
                    { name: "Берпи", duration: 45 },
                    { name: "Планка", duration: 45 }
                ]
            };
            let currentRound = 1;
            let currentExerciseIndex = 0;
            let timerInterval;

            document.getElementById('start-task-btn').addEventListener('click', startWorkout);
            document.getElementById('end-workout-btn').addEventListener('click', endWorkout);
            document.getElementById('close-summary-btn').addEventListener('click', closeSummary);

            function startWorkout() {
                currentRound = 1;
                currentExerciseIndex = 0;
                workoutOverlay.classList.remove('hidden');
                runExercise();
            }

            function runExercise() {
                const exercise = workoutPlan.exercises[currentExerciseIndex];
                const nextExercise = workoutPlan.exercises[(currentExerciseIndex + 1) % workoutPlan.exercises.length];
                
                document.getElementById('workout-round').textContent = `Круг ${currentRound} из ${workoutPlan.totalRounds}`;
                document.getElementById('exercise-name').textContent = exercise.name;
                document.getElementById('next-exercise-name').textContent = nextExercise.name;
                
                let timeLeft = exercise.duration;
                document.getElementById('timer-display').textContent = timeLeft;
                
                timerInterval = setInterval(() => {
                    timeLeft--;
                    document.getElementById('timer-display').textContent = timeLeft;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        nextStep();
                    }
                }, 1000);
            }
            
            function nextStep() {
                currentExerciseIndex++;
                if (currentExerciseIndex >= workoutPlan.exercises.length) {
                    currentExerciseIndex = 0;
                    currentRound++;
                }

                if (currentRound > workoutPlan.totalRounds) {
                    endWorkout(true); // Завершено успешно
                } else {
                    runExercise();
                }
            }

            function endWorkout(completed = false) {
                clearInterval(timerInterval);
                workoutOverlay.classList.add('hidden');
                summaryOverlay.classList.remove('hidden');
                if (!completed) {
                    showAlert("Тренировка прервана");
                }
            }

            function closeSummary() {
                summaryOverlay.classList.add('hidden');
                const summaryMessage = document.createElement('div');
                summaryMessage.className = 'flex items-start';
                summaryMessage.innerHTML = `<img src="https://i.pravatar.cc/32?img=5" class="h-8 w-8 rounded-full mr-2 flex-shrink-0"><div class="bg-gray-100 text-gray-800 p-3 rounded-lg max-w-xs"><p>Отличная работа! Горжусь тобой. Отдыхай.</p></div>`;
                chatLog.appendChild(summaryMessage);
                chatLog.scrollTop = chatLog.scrollHeight;
            }

            // --- Инициализация графика Chart.js ---
            const ctx = document.getElementById('progressChart').getContext('2d');
            const progressChart = new Chart(ctx, {
                type: 'line',
                data: { labels: ['Н1', 'Н2', 'Н3', 'Н4', 'Н5', 'Н6', 'Н7'], datasets: [{ label: 'Вес, кг', data: [76.5, 76.2, 75.8, 76.0, 75.5, 75.4, 75.2], backgroundColor: 'rgba(99, 102, 241, 0.1)', borderColor: 'rgba(99, 102, 241, 1)', borderWidth: 2, tension: 0.4, pointBackgroundColor: 'rgba(99, 102, 241, 1)', pointRadius: 4, fill: true }] },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: false, grid: { color: 'rgba(229, 231, 235, 0.5)' } }, x: { grid: { display: false } } }, plugins: { legend: { display: false } } }
            });

            // Инициализация при загрузке
            showScreen('dashboard');
            setActiveNav(document.querySelector('.nav-item[data-target="dashboard"]'));
        });
    </script>

</body>
</html>
